/**
 * angular-keyboard 
 * @license MIT License http://opensource.org/licenses/MIT
 */
!function(a,b){function c(a,b,c){return a.addEventListener?void a.addEventListener(b,c,!1):void a.attachEvent("on"+b,c)}function d(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase()),b}return y[a.which]?y[a.which]:z[a.which]?z[a.which]:String.fromCharCode(a.which).toLowerCase()}function e(a,b){return a.sort().join(",")===b.sort().join(",")}function f(a){a=a||{};var b,c=!1;for(b in E)a[b]?c=!0:E[b]=0;c||(H=!1)}function g(a,b,c,d,f,g){var h,i,j=[],k=c.type;if(!C[a])return[];for("keyup"==k&&n(a)&&(b=[a]),h=0;h<C[a].length;++h)if(i=C[a][h],(d||!i.seq||E[i.seq]==i.level)&&k==i.action&&("keypress"==k&&!c.metaKey&&!c.ctrlKey||e(b,i.modifiers))){var l=!d&&i.combo==f,m=d&&i.seq==d&&i.level==g;(l||m)&&C[a].splice(h,1),j.push(i)}return j}function h(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}function i(a){return a.preventDefault?void a.preventDefault():void(a.returnValue=!1)}function j(a){return a.stopPropagation?void a.stopPropagation():void(a.cancelBubble=!0)}function k(a,b,c,d){J.stopCallback(b,b.target||b.srcElement,c,d)||a(b,c)===!1&&(i(b),j(b))}function l(a,b,c){var d,e=g(a,b,c),h={},i=0,j=!1;for(d=0;d<e.length;++d)e[d].seq&&(i=Math.max(i,e[d].level));for(d=0;d<e.length;++d)if(e[d].seq){if(e[d].level!=i)continue;j=!0,h[e[d].seq]=1,k(e[d].callback,c,e[d].combo,e[d].seq)}else j||k(e[d].callback,c,e[d].combo);var l="keypress"==c.type&&G;c.type!=H||n(a)||l||f(h),G=j&&"keydown"==c.type}function m(a){"number"!=typeof a.which&&(a.which=a.keyCode);var b=d(a);if(b)return"keyup"==a.type&&F===b?void(F=!1):void J.handleKey(b,h(a),a)}function n(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function o(){clearTimeout(x),x=setTimeout(f,1e3)}function p(){if(!w){w={};for(var a in y)a>95&&112>a||y.hasOwnProperty(a)&&(w[y[a]]=a)}return w}function q(a,b,c){return c||(c=p()[a]?"keydown":"keypress"),"keypress"==c&&b.length&&(c="keydown"),c}function r(a,b,c,e){function g(b){return function(){H=b,++E[a],o()}}function h(b){k(c,b,a),"keyup"!==e&&(F=d(b)),setTimeout(f,10)}E[a]=0;for(var i=0;i<b.length;++i){var j=i+1===b.length,l=j?h:g(e||t(b[i+1]).action);u(b[i],l,e,a,i)}}function s(a){return"+"===a?["+"]:a.split("+")}function t(a,b){var c,d,e,f=[];for(c=s(a),e=0;e<c.length;++e)d=c[e],B[d]&&(d=B[d]),b&&"keypress"!=b&&A[d]&&(d=A[d],f.push("shift")),n(d)&&f.push(d);return b=q(d,f,b),{key:d,modifiers:f,action:b}}function u(a,b,c,d,e){D[a+":"+c]=b,a=a.replace(/\s+/g," ");var f,h=a.split(" ");return h.length>1?void r(a,h,b,c):(f=t(a,c),C[f.key]=C[f.key]||[],g(f.key,f.modifiers,{type:f.action},d,a,e),void C[f.key][d?"unshift":"push"]({callback:b,modifiers:f.modifiers,action:f.action,seq:d,level:e,combo:a}))}function v(a,b,c){for(var d=0;d<a.length;++d)u(a[d],b,c)}for(var w,x,y={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},z={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},A={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},B={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},C={},D={},E={},F=!1,G=!1,H=!1,I=1;20>I;++I)y[111+I]="f"+I;for(I=0;9>=I;++I)y[I+96]=I;c(b,"keypress",m),c(b,"keydown",m),c(b,"keyup",m);var J={bind:function(a,b,c){return a=a instanceof Array?a:[a],v(a,b,c),this},unbind:function(a,b){return J.bind(a,function(){},b)},trigger:function(a,b){return D[a+":"+b]&&D[a+":"+b]({},a),this},reset:function(){return C={},D={},this},stopCallback:function(a,b){return(" "+b.className+" ").indexOf(" mousetrap ")>-1?!1:"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.isContentEditable},handleKey:l};a.Mousetrap=J,"function"==typeof define&&define.amd&&define(J)}(window,document),angular.module("angular-keyboard",["ng"]),angular.module("angular-keyboard").filter("keybinding",["$sce",function(a){var b=function(a,b){var c=[];return angular.forEach(a,function(a,d){c.push(b(a,d))}),c},c={enter:"&#x23ce;","return":"&#x23ce;",command:"&#x2318;",option:"&#x2325;",alt:"&#x2325;",shift:"&#x21E7;",esc:"&#x238B;","delete":"&#x232b;",backspace:"&#x232b;",left:"&#8592;",right:"&#8594;",up:"&#8593;",down:"&#8595;",meta:"&#x2318;",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"&#x2318;":"Ctrl",ctrl:"Ctrl"},d={enter:"⏎","return":"⏎",command:"⌘",option:"⌥",alt:"⌥",shift:"⇧",esc:"⎋","delete":"⌫",backspace:"⌫",left:"←",right:"→",up:"↑",down:"↓",meta:"⌘",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"⌘":"Ctrl",ctrl:"Ctrl"};return function(e,f){return f?a.trustAsHtml(b(e.split(/\s+/),function(a){return b(a.split("+"),function(a){var b=c[a]?c[a]:a.toUpperCase();return"<kbd>"+b+"</kbd>"}).join("")}).join(' <span class="keyboard-separator">&#8250;</span> ')):b(e.split(/\s+/),function(a){return b(a.split("+"),function(a){var b=d[a]?d[a]:a.toUpperCase();return b}).join("")}).join(" › ")}}]),angular.module("angular-keyboard").directive("keyboardHelp",["KeyboardShortcuts",function(a){return{restrict:"EA",template:'<table><tr ng-repeat="shortcut in shortcuts"><td ng-bind-html="shortcut.keybinding | keybinding:true"></td><td>{{shortcut.name}}</td></tr></table>',scope:!0,link:function(b){b.$watch(function(){return a.actions()},function(a){b.shortcuts=a})}}}]),angular.module("angular-keyboard").directive("keyboardSelectable",["KeyboardShortcuts","$timeout",function(a,b){var c,d,e=0,f=[],g={},h=function(){var b;"class"===d?(f.removeClass(c),angular.element(f[e]).addClass(c)):angular.isString(d)&&(b=d.match(/click\((.*?)\)/))?""===b[1]?$(f[e]).click():$(f[e]).find(b[1]).click():angular.isFunction(d)&&d(f[e],f),angular.forEach(g,function(b,c){angular.forEach(b,function(b){a.remove(b.name,c)});var d=b[e.toString()];a.register(d.name,c,d.action,d.options)})};return{restrict:"A",controller:function(){return{register:function(a,b,c,d,e){g[c]=g[c]||{},g[c][a.toString()]={name:b,keybinding:c,action:d,options:e}},remove:function(a,b,c){delete g[c][a.toString()]}}},link:function(i,j,k){function l(){function a(a){!function d(){return f=j.find("[ng-repeat]"),a.length!==f.length?void b(d,100):(c=k.selectedClass||"keyboard-selected",e=f.index(f.filter("."+c)),0>e&&(e=0),void h())}()}if(f=j.find("[ng-repeat]"),0===f.length)b(l,100);else{var d=f.attr("ng-repeat").match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);i.$watchCollection(d[2],a)}}b(l,100),d=k.selectionAction?i.$eval(k.selectionAction):"class";var m={preventDefault:""===k.keyboardPreventDefault||"true"===k.keyboardPreventDefault||"keyboard-prevent-default"===k.keyboardPreventDefault,"private":""===k.privateShortcut||"true"===k.privateShortcut||"private-shortcut"===k.privateShortcut},n=k.keyboardSelectable||"";a.register("Select next "+n,k.selectNext,function(){e+=1,e===f.length&&(e=0),h()},m),a.register("Select previous "+n,k.selectPrevious,function(){e-=1,0>e&&(e=f.length-1),h()},m),i.$on("$destroy",function(){a.remove("Select previous "+n,k.selectPrevious),a.remove("Select next "+n,k.selectNext),angular.forEach(g,function(b,c){angular.forEach(b,function(b){a.remove(b.name,c)})})})}}}]),angular.module("angular-keyboard").directive("keyboardShortcut",["KeyboardShortcuts","$filter",function(a,b){return{restrict:"AE",require:"?^keyboardSelectable",link:function(c,d,e,f){function g(a){return a[0].title||a.text()||a.val()||a[0].id||a[0].name||a[0].tagName||a[0].innerText||a[0].value}function h(){""===e.selectionShortcut||"true"===e.selectionShortcut||"selection-shortcut"===e.selectionShortcut?f.register(c.$index,l,e.keyboardShortcut,j,m):a.register(l,e.keyboardShortcut,j,m)}function i(){""===e.selectionShortcut||"true"===e.selectionShortcut||"selection-shortcut"===e.selectionShortcut?f.remove(c.$index,l,e.keyboardShortcut):a.remove(l,e.keyboardShortcut)}var j,k=e.keyboardTrigger||"click";j=e.keyboardAction?function(){c.$apply(e.keyboardAction)}:function(){var a;document.createEvent?(a=document.createEvent("HTMLEvents"),a.initEvent(k,!0,!0)):(a=document.createEventObject(),a.eventType=k),a.eventName=k,document.createEvent?d[0].dispatchEvent(a):d[0].fireEvent("on"+a.eventType,a)},e.keyboardTitle&&!d[0].title&&(d[0].title=e.keyboardTitle+" ("+b("keybinding")(e.keyboardShortcut)+")");var l=e.keyboardTitle||g(d),m={preventDefault:""===e.keyboardPreventDefault||"true"===e.keyboardPreventDefault||"keyboard-prevent-default"===e.keyboardPreventDefault,"private":""===e.privateShortcut||"true"===e.privateShortcut||"private-shortcut"===e.privateShortcut};"keyboardCategory"in e&&(m.category=e.keyboardCategory),e.shortcutIf?c.$watch(e.shortcutIf,function(a){a?h():i()}):h(),c.$on("$destroy",function(){i()})}}}]),angular.module("angular-keyboard").service("KeyboardShortcuts",["$timeout",function(a){var b=[],c=[],d=function(b,c){return c.digest&&(b=function(b){return function(){a(b)}}(b)),c.preventDefault&&(b=function(a){return function(b){return a(),b.preventDefault(),!1}}(b)),b};return{register:function(a,e,f,g){g||(g={}),Mousetrap.bind(e,d(f,g)),g.private||b.push({name:a,keybinding:e,action:f,options:g}),c.push({name:a,keybinding:e,action:f,options:g})},remove:function(a,d){for(var e=!0,f=0;f<b.length;f++)if(b[f].name===a&&b[f].keybinding===d){b.splice(f,1);break}for(var f=0;f<c.length;f++){if(c[f].name===a&&c[f].keybinding===d){c.splice(f,1);break}c[f].name===a&&(e=!1)}if(e){Mousetrap.unbind(d);for(var f=0;f<c.length;f++)c[f].keybinding===d&&Mousetrap.bind(d,c[f].action)}},actions:function(){return b}}}]);